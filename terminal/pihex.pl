#!/usr/bin/env perl
use Term::Cap ();
use Time::HiRes 'sleep';
use Term::ReadKey 'GetTerminalSize';

my $pi = <<"EOF";
03 .243F6A8885A308D313198A2E03707344A4093822299F31D0082EFA98EC4E6C8945
2821E638D01377BE5466CF34E90C6CC0AC29B7C97C50DD3F84D5B5B54709179216D5
D98979FB1BD1310BA698DFB5AC2FFD72DBD01ADFB7B8E1AFED6A267E96BA7C9045F1
2C7F9924A19947B3916CF70801F2E2858EFC16636920D871574E69A458FEA3F4933D
7E0D95748F728EB658718BCD5882154AEE7B54A41DC25A59B59C30D5392AF26013C5
D1B023286085F0CA417918B8DB38EF8E79DCB0603A180E6C9E0E8BB01E8A3ED71577
C1BD314B2778AF2FDA55605C60E65525F3AA55AB945748986263E8144055CA396A2A
AB10B6B4CC5C341141E8CEA15486AF7C72E993B3EE1411636FBC2A2BA9C55D741831
F6CE5C3E169B87931EAFD6BA336C24CF5C7A325381289586773B8F48986B4BB9AFC4
BFE81B6628219361D809CCFB21A991487CAC605DEC8032EF845D5DE98575B1DC2623
02EB651B8823893E81D396ACC50F6D6FF383F442392E0B4482A484200469C8F04A9E
1F9B5E21C66842F6E96C9A670C9C61ABD388F06A51A0D2D8542F68960FA728AB5133
A36EEF0B6C137A3BE4BA3BF0507EFB2A98A1F1651D39AF017666CA593E82430E888C
EE8619456F9FB47D84A5C33B8B5EBEE06F75D885C12073401A449F56C16AA64ED3AA
62363F77061BFEDF72429B023D37D0D724D00A1248DB0FEAD349F1C09B075372C980
991B7B25D479D8F6E8DEF7E3FE501AB6794C3B976CE0BD04C006BAC1A94FB6409F60
C45E5C9EC2196A246368FB6FAF3E6C53B51339B2EB3B52EC6F6DFC511F9B30952CCC
814544AF5EBD09BEE3D004DE334AFD660F2807192E4BB3C0CBA85745C8740FD20B5F
39B9D3FBDB5579C0BD1A60320AD6A100C6402C7279679F25FEFB1FA3CC8EA5E9F8DB
3222F83C7516DFFD616B152F501EC8AD0552AB323DB5FAFD23876053317B483E00DF
829E5C57BBCA6F8CA01A87562EDF1769DBD542A8F6287EFFC3AC6732C68C4F557369
5B27B0BBCA58C8E1FFA35DB8F011A010FA3D98FD2183B84AFCB56C2DD1D35B9A53E4
79B6F84565D28E49BC4BFB9790E1DDF2DAA4CB7E3362FB1341CEE4C6E8EF20CADA36
774C01D07E9EFE2BF11FB495DBDA4DAE909198EAAD8E716B93D5A0D08ED1D0AFC725
E08E3C5B2F8E7594B78FF6E2FBF2122B648888B812900DF01C4FAD5EA0688FC31CD1
CFF191B3A8C1AD2F2F2218BE0E1777EA752DFE8B021FA1E5A0CC0FB56F74E818ACF3
D6CE89E299B4A84FE0FD13E0B77CC43B81D2ADA8D9165FA2668095770593CC731421
1A1477E6AD206577B5FA86C75442F5FB9D35CFEBCDAF0C7B3E89A0D6411BD3AE1E7E
4900250E2D2071B35E226800BB57B8E0AF2464369BF009B91E5563911D59DFA6AA78
C14389D95A537F207D5BA202E5B9C5832603766295CFA911C819684E734A41B3472D
CA7B14A94A1B5100529A532915D60F573FBC9BC6E42B60A47681E6740008BA6FB557
1BE91FF296EC6B2A0DD915B6636521E7B9F9B6FF34052EC585566453B02D5DA99F8F
A108BA47996E85076A4B7A70E9B5B32944DB75092EC4192623AD6EA6B049A7DF7D9C
EE60B88FEDB266ECAA8C71699A17FF5664526CC2B19EE1193602A575094C29A05913
40E4183A3E3F54989A5B429D656B8FE4D699F73FD6A1D29C07EFE830F54D2D38E6F0
255DC14CDD20868470EB266382E9C6021ECC5E09686B3F3EBAEFC93C9718146B6A70
A1687F358452A0E286B79C5305AA5007373E07841C7FDEAE5C8E7D44EC5716F2B8B0
3ADA37F0500C0DF01C1F040200B3FFAE0CF51A3CB574B225837A58DC0921BDD19113
F97CA92FF69432477322F547013AE5E58137C2DADCC8B576349AF3DDA7A94461460F
D0030EECC8C73EA4751E41E238CD993BEA0E2F3280BBA1183EB3314E548B384F6DB9
086F420D03F60A04BF2CB8129024977C795679B072BCAF89AFDE9A771FD9930810B3
8BAE12DCCF3F2E5512721F2E6B7124501ADDE69F84CD877A5847187408DA17BC9F9A
BCE94B7D8CEC7AEC3ADB851DFA63094366C464C3D2EF1C18473215D908DD433B3724
C2BA1612A14D432A65C45150940002133AE4DD71DFF89E10314E5581AC77D65F1119
9B043556F1D7A3C76B3C11183B5924A509F28FE6ED97F1FBFA9EBABF2C1E153C6E86
E34570EAE96FB1860E5E0A5A3E2AB3771FE71C4E3D06FA2965DCB999E71D0F803E89
D65266C8252E4CC9789C10B36AC6150EBA94E2EA78A5FC3C531E0A2DF4F2F74EA736
1D2B3D1939260F19C279605223A708F71312B6EBADFE6EEAC31F66E3BC4595A67BC8
83B17F37D1018CFF28C332DDEFBE6C5AA56558218568AB9802EECEA50FDB2F953B2A
EF7DAD5B6E2F841521B62829076170ECDD4775619F151013CCA830EB61BD960334FE
1EA4
EOF
$pi =~ s/\n//g;

$pi = $ARGV[0] // $pi;

my $fill = '██';
my $empty = '▒▒';
my $start = 0;
my $width = (GetTerminalSize)[0] - 1;
my $term = Term::Cap->Tgetent;

$pi = '  'x($width/2) . $pi . '  'x($width/2);

while ($start < length $pi) {
    print $term->Tgoto('cm', 0, 0);
    $width = (GetTerminalSize)[0] - 1;
    print substr($pi, $start, $width), "\n";
    for my $bit (0..7) {
        my $pos = 0;
        while ($pos < $width) {
            my $slice = substr $pi, $pos + $start, 2;
            if ($slice !~ /[0-9A-F]/) {
                print '  ';
            } else {
                $slice = hex $slice;
                print(($slice >> $bit) & 1 ? $fill : $empty);
            }
            $pos += 2;
        }
        print "\n";
    }
    $start += 2;
    $| = 1;
    $| = 0;
    sleep 0.1;
}
